# ===================================================
# passwd-sso Environment Variables
# ===================================================
# Copy this file to .env.local and fill in the values.
# NEVER commit .env.local to version control.
# ===================================================

# --- Application ---
# Display name shown in the UI (header, sign-in page, etc.)
# NEXT_PUBLIC_APP_NAME=passwd-sso

# --- Database ---
DATABASE_URL=postgresql://passwd_user:passwd_pass@localhost:5432/passwd_sso

# --- NextAuth ---
# Base URL of the application
AUTH_URL=http://localhost:3000
# Generate with: openssl rand -base64 32
AUTH_SECRET=

# --- Google OIDC ---
AUTH_GOOGLE_ID=
AUTH_GOOGLE_SECRET=
# Optional: restrict sign-in to a specific domain (e.g., example.com)
# Leave empty to allow any Google account including personal ones.
GOOGLE_WORKSPACE_DOMAIN=

# --- SAML Jackson (SAML 2.0 to OIDC bridge) ---
# URL of the SAML Jackson service
JACKSON_URL=http://localhost:5225
# Client ID/Secret configured in SAML Jackson
AUTH_JACKSON_ID=
AUTH_JACKSON_SECRET=
# Display name for the SAML IdP on the sign-in page (e.g., HENNGE, Okta, Azure AD)
SAML_PROVIDER_NAME=SSO

# --- Organization Vault ---
# Master key for wrapping per-org encryption keys (256-bit hex)
# Generate with: openssl rand -hex 32
SHARE_MASTER_KEY=
# Pepper key for passphrase verifier HMAC (256-bit hex)
# Required when NODE_ENV=production
# Generate with: openssl rand -hex 32
VERIFIER_PEPPER_KEY=

# --- Rate limiting (Redis, optional) ---
# Redis URL for shared rate limiting (recommended for production).
# If not set, rate limiting is disabled and the app works without Redis.
# REDIS_URL=redis://localhost:6379

# --- Attachment Blob Storage Backend ---
# Storage backend for encrypted attachment payloads.
# Supported: db | s3 | azure | gcs
BLOB_BACKEND=db

# S3 backend (required when BLOB_BACKEND=s3)
# AWS_REGION=ap-northeast-1
# S3_ATTACHMENTS_BUCKET=passwd-sso-attachments

# Azure Blob backend (required when BLOB_BACKEND=azure)
# AZURE_STORAGE_ACCOUNT=
# AZURE_BLOB_CONTAINER=attachments
# Either connection string or SAS token is required for runtime access
# AZURE_STORAGE_CONNECTION_STRING=
# AZURE_STORAGE_SAS_TOKEN=

# GCS backend (required when BLOB_BACKEND=gcs)
# GCS_ATTACHMENTS_BUCKET=passwd-sso-attachments

# Optional object key prefix across cloud backends
# BLOB_OBJECT_PREFIX=passwd-sso

# --- Audit Log Forwarding (optional) ---
# Emit structured JSON audit logs to stdout for external collection.
# Use with Fluent Bit sidecar: docker compose -f docker-compose.yml -f docker-compose.logging.yml up
# AUDIT_LOG_FORWARD=true
# AUDIT_LOG_APP_NAME=passwd-sso

# --- Email (optional) ---
# Provider: "resend" | "smtp". Leave empty to disable email sending.
# EMAIL_PROVIDER=
# EMAIL_FROM=noreply@example.com
# Resend provider (EMAIL_PROVIDER=resend)
# RESEND_API_KEY=
# SMTP provider (EMAIL_PROVIDER=smtp)
# For development with Mailpit (docker-compose.override.yml):
#   SMTP_HOST=localhost  SMTP_PORT=1025  EMAIL_FROM=noreply@localhost
# SMTP_HOST=
# SMTP_PORT=587
# SMTP_USER=
# SMTP_PASS=

# --- DB Connection Pool Tuning (optional) ---
# All values have sensible defaults. Override only if needed.
# DB_POOL_MAX=20
# DB_POOL_CONNECTION_TIMEOUT_MS=5000
# DB_POOL_IDLE_TIMEOUT_MS=30000
# DB_POOL_MAX_LIFETIME_SECONDS=1800
# DB_POOL_STATEMENT_TIMEOUT_MS=30000
