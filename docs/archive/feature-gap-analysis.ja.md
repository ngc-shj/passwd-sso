# 機能ギャップ分析レポート

最終更新: 2026-02-20

## 目的

passwd-sso と主要パスワードマネージャー（1Password, Bitwarden, LastPass, Dashlane, KeePassXC, Proton Pass, NordPass）を機能面で比較し、不足機能を特定する。

## 調査対象

| 製品 | 特徴 |
| --- | --- |
| 1Password | 22+ エントリタイプ、SSH Agent、Travel Mode、Secrets Automation |
| Bitwarden | OSS、Send（一時共有）、Secrets Manager、セルフホスト対応 |
| LastPass | ダークウェブ監視、SaaS 監視、15+ セキュアノートテンプレート |
| Dashlane | 内蔵 VPN、Confidential SSO、フィッシング検知 |
| KeePassXC | ローカル完結、Auto-Type、SSH Agent、Secret Service API |
| Proton Pass | メールエイリアス、Pass Monitor、Swiss 管轄 |
| NordPass | XChaCha20、メールマスキング、オフラインモード |

---

## 1. passwd-sso 実装済み機能サマリ

### 暗号化・セキュリティ

- E2E 暗号化 (PBKDF2 600k → HKDF → AES-256-GCM)
- 組織 Vault E2E 暗号化（ECDH-P256 鍵配布）
- 自動ロック (15 分無操作 / 5 分タブ非表示)
- アカウントロックアウト (段階的: 5 回 → 15 分, 10 回 → 1h, 15 回 → 24h)
- レートリミット (Redis + インメモリフォールバック)
- CSP + nonce + セキュリティヘッダー (HSTS, X-Frame-Options 等)
- パスフレーズ検証 (HMAC ベース)
- クリップボード自動クリア (30 秒後、Web UI)
- マスターパスワード再確認 (reprompt フラグ、表示/コピー/編集時)

### Vault 管理

- 5 エントリタイプ (LOGIN, SECURE_NOTE, CREDIT_CARD, IDENTITY, PASSKEY)
- お気に入り / アーカイブ / ゴミ箱 (30 日自動パージ)
- 一括操作 (アーカイブ / ゴミ箱 / 復元 / 完全削除)
- タグ (カラー付き、ユーザー単位のユニーク制約)
- カスタムフィールド (TEXT, HIDDEN, URL)
- ファイル添付 (10 MB, エントリあたり 20 件、E2E 暗号化)
- フォルダ / 階層グループ (個人 + 組織、最大 5 階層、循環参照検出)
- エントリ変更履歴 (最大 20 件 / エントリ、90 日パージ、復元機能)
- 重複エントリ検出 (Watchtower、ホスト名 + ユーザー名一致)
- エントリ有効期限 (expiresAt、Watchtower で期限切れ検出)

### パスワード生成・分析

- ランダムパスワード (8-128 文字, 6 シンボルグループ)
- パスフレーズ (3-10 単語、BIP39 ワードリスト)
- Watchtower (HIBP k-Anonymity, 弱い / 再利用 / 古い / HTTP / 重複 / 期限切れ検出)
- エントロピー計算、パターン検出 (キーボード配列、連続文字等)

### 共有・コラボレーション

- 共有リンク (期限 / 最大閲覧数 / 取消可 / アクセスログ)
- Send (Bitwarden Send 相当: テキスト / ファイル、暗号化一時共有)
- 組織 Vault (RBAC: OWNER, ADMIN, MEMBER, VIEWER)
- 招待フロー (トークン + 有効期限)
- 組織単位のタグ・お気に入り・フォルダ

### 緊急アクセス

- ECDH-P256 鍵交換 + ML-KEM ハイブリッド (PQC 対応)
- 8 段階ステートマシン (PENDING → ACTIVATED)
- 待機期間 (7/14/30 日)

### リカバリ

- 回復キー (256-bit, Base32, HKDF + AES-256-GCM)
- Vault リセット (全データ削除、最終手段)
- パスフレーズ変更 / 鍵ローテーション (API 準備済み)

### その他

- ブラウザ拡張 (Chrome MV3, フォーム検出, 手動自動入力, TOTP 自動入力)
- i18n (ja / en、884 キー)
- 監査ログ (34 アクション、Personal + Org)
- インポート / エクスポート (CSV, JSON, パスワード保護暗号化)
- ダークモード / キーボードショートカット
- ヘルスチェック / 構造化ログ / Terraform IaC

---

## 2. 機能ギャップ一覧

### 2.1 セキュリティ

| # | 機能 | 1P | BW | LP | DL | KP | PP | NP | 影響度 | 実装難易度 |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| ~~S-1~~ | ~~クリップボード自動クリア~~ | Yes | Yes | Yes | Yes | Yes | Yes | Yes | — | — |
| ~~S-2~~ | ~~マスターパスワード再確認 (機密項目)~~ | - | Yes | - | - | - | Yes | - | — | — |
| ~~S-3~~ | ~~FIDO2 / WebAuthn (ログイン 2FA)~~ | Yes | Yes | Yes | Yes | - | Yes | Yes | — | — |
| S-4 | パスキーによる Vault アンロック | - | Yes | - | - | - | - | - | 中 | 高 |
| S-5 | 並行セッション管理 (一覧/取消) | Yes | Yes | Yes | Yes | - | Yes | Yes | 中 | 中 |
| S-6 | 新規デバイスログイン通知 | Yes | Yes | Yes | Yes | - | Yes | Yes | 中 | 中 |
| S-7 | フィッシング検知アラート | - | - | - | Yes | - | - | - | 低 | 高 |

> **設計方針による除外: S-3 FIDO2 / WebAuthn (ログイン 2FA)**
> passwd-sso は OSS 前提のため、アプリ側に認証機能を組み込まない方針。ログイン認証 (MFA/2FA 含む) は外部 IdP (Google OAuth, SAML IdP) に完全委譲する。IdP 側で FIDO2 セキュリティキーを設定すれば同等のセキ
ュリティを確保できる。

**凡例:** 1P=1Password, BW=Bitwarden, LP=LastPass, DL=Dashlane, KP=KeePassXC, PP=Proton Pass, NP=NordPass

#### ~~S-1 クリップボード自動クリア~~ — 実装済み (2026-02-20)

30 秒後に自動クリア (`navigator.clipboard.writeText("")`)。Web UI の `CopyButton` コンポーネントで実装。

#### ~~S-2 マスターパスワード再確認~~ — 実装済み (2026-02-18)

`PasswordEntry.requireReprompt` フラグ追加。表示・コピー・編集時にマスターパスワード再入力を要求。`RepromptDialog` + `useReprompt` hook で実装。

#### ~~S-3 FIDO2 / WebAuthn~~ — 対象外

OSS 前提の設計方針により、アプリ側に認証機能を組み込まない。MFA/2FA は外部 IdP 側で設定する運用を想定 (Google は Advanced Protection Program 対応、SAML IdP は各製品の MFA 機能を利用)。

---

### 2.2 Vault 管理・整理

| # | 機能 | 1P | BW | LP | DL | KP | PP | NP | 影響度 | 実装難易度 |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| ~~V-1~~ | ~~フォルダ / 階層グループ~~ | Vault | Folder+Collection | Folder | Collection | 階層 Group | Vault+Folder | Folder | — | — |
| ~~V-2~~ | ~~エントリ変更履歴~~ | Yes | Yes | - | - | Yes | - | - | — | — |
| ~~V-3~~ | ~~重複エントリ検出~~ | Yes | - | - | - | - | - | - | — | — |
| ~~V-4~~ | ~~エントリ有効期限 / ローテーション通知~~ | Yes | - | Yes | - | Yes | - | - | — | — |
| V-5 | 複数 Vault (個人用) | Yes | - | - | - | Yes | Yes | - | 低 | 高 |
| V-6 | ネストタグ (階層タグ) | Yes | - | - | - | - | - | - | 低 | 低 |

#### ~~V-1 フォルダ / 階層グループ~~ — 実装済み (2026-02-18)

`Folder` / `OrgFolder` テーブルで個人 + 組織の階層フォルダを実装。最大 5 階層、循環参照検出、ドラッグ&ドロップ並び替え対応。タグとフォルダを共存させ、フォルダは階層整理、タグは横断分類として使い分け。

#### ~~V-2 エントリ変更履歴~~ — 実装済み (2026-02-18)

`PasswordEntryHistory` / `OrgPasswordEntryHistory` テーブル追加。PUT 時に旧 `encryptedBlob` を自動スナップショット。最大 20 件 / エントリ、90 日パージ、復元機能付き。機密フィールドのマスキングと reprompt ガード対応。

#### ~~V-3 重複エントリ検出~~ — 実装済み (2026-02-20)

Watchtower に重複検出セクション追加。`encryptedOverview` の urlHost + username をクライアント側で復号後に比較 (`www.` 正規化対応)。スコア計算に 5% の重みで反映。

#### ~~V-4 エントリ有効期限~~ — 実装済み (2026-02-20)

`PasswordEntry.expiresAt` フィールド追加。日付ピッカー UI、Watchtower で期限切れ / 期限間近検出、パスワードカードにバッジ表示。

---

### 2.3 エントリ種別

| # | 機能 | 1P | BW | LP | DL | KP | PP | NP | 影響度 | 実装難易度 |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| E-1 | SSH 鍵 (+ SSH Agent) | Yes | Yes | - | - | Yes | - | - | 高 | 高 |
| E-2 | 銀行口座 | Yes | - | Yes | Yes | - | - | - | 中 | 低 |
| E-3 | ソフトウェアライセンス | Yes | - | Yes | - | - | - | - | 中 | 低 |
| E-4 | カスタムフィールド: BOOLEAN | - | Yes | - | - | - | - | - | 低 | 低 |
| E-5 | カスタムフィールド: DATE, MONTH_YEAR | Yes | - | - | - | - | - | - | 低 | 低 |
| E-6 | セキュアノート Markdown 対応 | Yes | - | - | - | - | - | - | 低 | 低 |

#### E-1 SSH 鍵管理

- **現状:** SSH 鍵タイプは未サポート
- **競合:** 1Password (SSH Agent 統合 + Git 署名), Bitwarden (SSH Agent), KeePassXC (SSH Agent + Auto-Type)
- **提案:** 新エントリタイプ `SSH_KEY` を追加。フィールド: `privateKey` (暗号化), `publicKey`, `fingerprint`, `keyType` (Ed25519, RSA, ECDSA), `comment`。将来的に SSH Agent プロキシを実装

#### E-2 / E-3 銀行口座・ソフトウェアライセンス

- **現状:** IDENTITY タイプのカスタムフィールドで代用可能だが、専用 UI なし
- **提案:** 既存の `entryType` enum に `BANK_ACCOUNT`, `SOFTWARE_LICENSE` を追加。暗号化ブロブの構造に専用フィールドセットを定義

---

### 2.4 ブラウザ拡張

| # | 機能 | 1P | BW | LP | DL | KP | PP | NP | 影響度 | 実装難易度 |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| ~~X-1~~ | ~~TOTP コード自動入力~~ | Yes | Yes | - | - | Yes | Yes | Yes | — | — |
| X-2 | クレジットカード / 住所の自動入力 | Yes | Yes | Yes | Yes | - | Yes | Yes | 中 | 中 |
| X-3 | コンテキストメニュー (右クリック) | Yes | Yes | Yes | - | - | - | - | 中 | 低 |
| X-4 | 拡張キーボードショートカット | Yes | Yes | - | - | - | - | - | 中 | 低 |
| X-5 | 新規ログイン自動検出・保存 | Yes | Yes | Yes | Yes | Yes | Yes | Yes | 高 | 中 |
| X-6 | TOTP QR コードキャプチャ | - | Yes | - | - | - | - | - | 低 | 中 |

#### ~~X-1 TOTP コード自動入力~~ — 実装済み (2026-01)

拡張機能で TOTP コード生成 (SHA1/SHA256/SHA512) + 2FA フィールドへの自動入力を実装。ログイン自動入力後に自動実行。TOTP 生成失敗時もパスワード自動入力はブロックしない。

#### X-5 新規ログイン自動検出

- **現状:** フォーム検出は実装済みだが、フォーム送信後の自動保存プロンプトが不完全
- **提案:** `submit` イベント / `fetch` / `XMLHttpRequest` をインターセプトし、成功レスポンス後に「保存しますか？」通知を表示

---

### 2.5 クロスプラットフォーム

| # | 機能 | 1P | BW | LP | DL | KP | PP | NP | 影響度 | 実装難易度 |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| P-1 | モバイルアプリ (iOS / Android) | Yes | Yes | Yes | Yes | 3rd party | Yes | Yes | 高 | 非常に高 |
| P-2 | CLI ツール (Vault 操作) | Yes | Yes | - | - | Yes | 計画中 | - | 中 | 中 |
| P-3 | オフラインアクセス | Yes | Yes | 一部 | 一部 | Yes | Yes | Yes | 中 | 高 |
| P-4 | デスクトップアプリ | Yes | Yes | - | - | Yes | Yes | Yes | 低 | 高 |
| P-5 | 生体認証 (Touch ID / Face ID) | Yes | Yes | Yes | Yes | - | Yes | Yes | 中 | P-1 前提 |

#### P-1 モバイルアプリ

- **現状:** Web UI のみ。モバイルブラウザでのアクセスは可能だがネイティブ自動入力なし
- **競合:** 全製品が iOS / Android ネイティブアプリを提供
- **提案:** React Native または Capacitor/Ionic で既存 React コンポーネントを再利用。iOS/Android Credential Provider API 統合。Web Crypto API は `react-native-quick-crypto` で代替

#### P-2 CLI ツール

- **現状:** CLI なし。ブラウザ拡張または Web UI のみ
- **競合:** 1Password `op`、Bitwarden CLI、KeePassXC `keepassxc-cli`
- **提案:** Node.js ベースの CLI パッケージ。`commander` + 既存暗号化ライブラリで実装。CI/CD シークレット注入、スクリプト連携に有用

---

### 2.6 共有・コラボレーション

| # | 機能 | 1P | BW | LP | DL | KP | PP | NP | 影響度 | 実装難易度 |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| ~~C-1~~ | ~~Send (非ユーザーへのテキスト/ファイル送信)~~ | - | Yes | - | - | - | - | - | — | — |
| C-2 | 共有権限の細分化 (閲覧/編集/管理) | Yes | Yes | Yes | Yes | - | Yes | - | 中 | 中 |
| C-3 | Vault 単位の共有 | Yes | Collection | - | - | KeeShare | Yes | - | 低 | 高 |

#### ~~C-1 Send 機能~~ — 実装済み (2026-02-19)

Bitwarden Send 相当のテキスト / ファイル一時共有を実装。`PasswordShare` モデルに `sendContentType` 追加。期限・閲覧数制限・パスワード保護・取消可能。監査ログ (`SEND_CREATE`, `SEND_REVOKE`) 対応。サイドバーは「共有」メニューに統合。

---

### 2.7 通知・アラート

| # | 機能 | 1P | BW | LP | DL | KP | PP | NP | 影響度 | 実装難易度 |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| N-1 | メール通知 (漏洩検出) | Yes | Yes | Yes | Yes | - | Yes | Yes | 高 | 中 |
| N-2 | アプリ内通知センター | Yes | Yes | Yes | Yes | - | Yes | Yes | 中 | 中 |
| ~~N-3~~ | ~~パスワード変更リマインダー~~ | Yes | - | Yes | - | Yes | - | - | — | — |
| N-4 | 緊急アクセスリクエスト通知 (メール) | - | Yes | Yes | - | - | - | Yes | 中 | 低 |

#### N-1 メール通知

- **現状:** 漏洩検出は Watchtower UI のみ。メール通知なし
- **提案:** トランザクションメール基盤を導入 (SendGrid / Amazon SES / Resend)。通知種別: 漏洩検出、緊急アクセスリクエスト、新規デバイスログイン、パスワード期限切れ

---

### 2.8 エンタープライズ

| # | 機能 | 1P | BW | LP | DL | KP | PP | NP | 影響度 | 実装難易度 |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| B-1 | SCIM プロビジョニング | Yes | Yes | Yes | Yes | - | Yes | Yes | 高 | 高 |
| B-2 | ディレクトリ同期 (AD / Azure AD / LDAP) | Yes | Yes | Yes | Yes | - | - | - | 中 | 高 |
| B-3 | SIEM 連携 (Events API) | Yes | Yes | Yes | Yes | - | - | - | 中 | 中 |
| B-4 | セキュリティポリシー (強制 2FA、PW 要件等) | Yes | Yes | Yes | Yes | - | Yes | Yes | 中 | 中 |
| B-5 | 管理者パスワードリセット | Yes | Yes | Yes | - | - | - | Yes | 低 | 中 |

#### B-1 SCIM プロビジョニング

- **現状:** 組織メンバーは手動招待のみ
- **競合:** エンタープライズ製品は全て SCIM 2.0 対応
- **提案:** `/api/scim/v2/Users` + `/api/scim/v2/Groups` エンドポイントを追加。Okta / Azure AD / Google Workspace との連携
- **参考:** `docs/archive/scim-provisioning.md` に既存の検討あり

#### B-3 SIEM 連携

- **現状:** 監査ログは DB 保存 + pino stdout 出力。外部 SIEM への API 提供なし
- **提案:** 監査ログの REST API エクスポート (JSON Lines / CSV)。Webhook 通知オプション追加

---

### 2.9 開発者向け

| # | 機能 | 1P | BW | LP | DL | KP | PP | NP | 影響度 | 実装難易度 |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| D-1 | SSH Agent 統合 | Yes | Yes | - | - | Yes | - | - | 高 | 高 |
| D-2 | シークレット管理 (CI/CD) | Yes | Yes | - | - | API | 計画中 | - | 中 | 中 |
| D-3 | REST API (外部連携) | Yes | Yes | - | - | - | - | - | 低 | 中 |

---

### 2.10 ユニーク差別化機能

| # | 機能 | 提供元 | 影響度 | 実装難易度 |
| --- | --- | --- | --- | --- |
| U-1 | メールエイリアス生成 | Proton Pass (無制限), NordPass (200) | 中 | 高 |
| U-2 | ダークウェブ継続監視 | Dashlane, LastPass | 中 | 中 |
| U-3 | トラベルモード | 1Password | 低 | 中 |
| U-4 | セキュアノートテンプレート | LastPass (15+ 種) | 低 | 低 |

---

## 3. 優先度マトリクス

### 評価基準

- **影響度:** ユーザー価値 + セキュリティ向上度 + 競争力
- **実装難易度:** 既存アーキテクチャとの整合性 + 工数

```
          影響度 高
              │
     P1       │      P0
   (計画的)   │   (最優先)
              │
  ────────────┼────────────→ 実装難易度 低
              │
     P3       │      P2
   (検討)     │   (早期着手)
              │
          影響度 低
```

### P0: 最優先（高影響 × 低難易度） — ✅ 完了

| ID | 機能 | 状態 |
| --- | --- | --- |
| ~~S-1~~ | クリップボード自動クリア | ✅ 2026-02-20 |
| ~~S-2~~ | マスターパスワード再確認 | ✅ 2026-02-18 |
| ~~V-4~~ | エントリ有効期限 | ✅ 2026-02-20 |
| ~~V-3~~ | 重複エントリ検出 | ✅ 2026-02-20 |
| ~~N-3~~ | パスワード変更リマインダー | ✅ 2026-02-20 |

> **N-4 (緊急アクセス通知)** は N-1 メール基盤に依存するため P1 へ移動。

### P1: 計画的実装（高影響 × 中〜高難易度） — 一部完了

| ID | 機能 | 状態 |
| --- | --- | --- |
| ~~V-1~~ | フォルダ / 階層グループ | ✅ 2026-02-18 |
| ~~V-2~~ | エントリ変更履歴 | ✅ 2026-02-18 |
| ~~X-1~~ | TOTP 自動入力 (拡張) | ✅ 2026-01 |
| ~~C-1~~ | Send (一時共有) | ✅ 2026-02-19 |
| X-5 | 新規ログイン自動検出 | 未着手 |
| N-1 | メール通知基盤 | 未着手 |
| N-4 | 緊急アクセス通知 (メール) | 未着手 (N-1 前提) |
| B-1 | SCIM プロビジョニング | 未着手 |

### P2: 早期着手（中影響 × 低〜中難易度）

| ID | 機能 | 根拠 |
| --- | --- | --- |
| S-5 | セッション管理 | DB セッション既存。UI 追加が主 |
| S-6 | ログイン通知 | N-1 メール基盤の上に構築 |
| E-2 | 銀行口座タイプ | enum 追加 + UI |
| E-3 | ソフトウェアライセンスタイプ | enum 追加 + UI |
| X-3 | コンテキストメニュー | Chrome API `contextMenus` |
| X-4 | 拡張キーボードショートカット | Chrome API `commands` |
| C-2 | 共有権限細分化 | 既存 RBAC の拡張 |
| B-3 | SIEM 連携 | 監査ログ REST API 公開 |
| B-4 | セキュリティポリシー | 組織設定テーブル追加 |
| P-2 | CLI ツール | 開発者向け差別化 |
| V-6 | ネストタグ | `/` 区切りの階層表現 |
| U-4 | セキュアノートテンプレート | 定義追加のみ |
| N-2 | アプリ内通知センター | Watchtower とは別の汎用通知 UI |
| E-4 | カスタムフィールド: BOOLEAN | enum 追加のみ |
| E-5 | カスタムフィールド: DATE, MONTH_YEAR | enum 追加のみ |
| E-6 | セキュアノート Markdown | エディタ統合 |

### P3: 中長期検討（低影響 or 高難易度）

| ID | 機能 | 根拠 |
| --- | --- | --- |
| S-4 | パスキー Vault アンロック | 暗号鍵の導出方法に影響。設計検討が必要 |
| P-1 | モバイルアプリ | 工数が非常に大きい。専任チームが必要 |
| P-3 | オフラインアクセス | Service Worker + IndexedDB。同期設計が複雑 |
| P-4 | デスクトップアプリ | Electron / Tauri。Web で代替可能 |
| E-1 | SSH 鍵 + SSH Agent | 新エントリタイプ + ネイティブプロセス連携 |
| D-1 | SSH Agent 統合 | デスクトップアプリ / CLI 前提 |
| D-2 | シークレット管理 | CLI + API 前提 |
| B-2 | ディレクトリ同期 | SCIM 対応後に検討 |
| V-5 | 複数 Vault | 暗号鍵管理の設計変更が大きい |
| U-1 | メールエイリアス | メールインフラ構築が必要 |
| U-3 | トラベルモード | ニッチ機能 |

---

## 4. 推奨ロードマップ

### Phase 1: セキュリティ基盤強化 (P0) — ✅ 完了

```
目標: 競合と同等のセキュリティ基本機能を確保
完了日: 2026-02-20
```

1. ~~**S-1** クリップボード自動クリア~~ ✅
2. ~~**S-2** マスターパスワード再確認フラグ~~ ✅
3. ~~**V-3** 重複エントリ検出 (Watchtower 拡張)~~ ✅
4. ~~**V-4** エントリ有効期限 + **N-3** 変更リマインダー~~ ✅

### Phase 2: UX 向上 + 拡張機能強化 (P1 前半) — ほぼ完了

```
目標: 日常利用の利便性を大幅に改善
残: X-5 のみ
```

5. ~~**V-1** フォルダ / 階層グループ~~ ✅
6. ~~**V-2** エントリ変更履歴~~ ✅
7. ~~**X-1** TOTP 自動入力 (拡張機能)~~ ✅
8. **X-5** 新規ログイン自動検出

### Phase 3: 通知 + 共有強化 (P1 後半) — 一部完了

```
目標: 通知基盤の確立とコラボレーション強化
残: N-1, N-4
```

9. **N-1** メール通知基盤
10. **N-4** 緊急アクセスリクエスト通知
11. ~~**C-1** Send (一時共有)~~ ✅

### Phase 4: エンタープライズ対応 (P1 + P2)

```
目標: 企業利用に必要な管理機能の追加
```

1. **B-1** SCIM プロビジョニング
2. **B-4** セキュリティポリシー
3. **B-3** SIEM 連携
4. **S-5** セッション管理

### Phase 5: プラットフォーム拡張 (P2 + P3)

```
目標: マルチプラットフォーム対応
```

1. **P-2** CLI ツール
2. **E-1** SSH 鍵管理
3. **P-1** モバイルアプリ (iOS / Android)
4. **P-3** オフラインアクセス

---

## 5. 競合比較サマリ (現状)

全機能を集計した対応率:

| 製品 | 対応カテゴリ数 (/11) | 強み |
| --- | --- | --- |
| 1Password | 11/11 | エントリ種別 (22+)、SSH Agent、Travel Mode、Secrets |
| Bitwarden | 10/11 | OSS、Send、セルフホスト、SCIM |
| LastPass | 8/11 | ダークウェブ常時監視、SaaS 監視 |
| Dashlane | 8/11 | VPN 内蔵、Confidential SSO、フィッシング検知 |
| KeePassXC | 7/11 | 完全ローカル、SSH Agent、Auto-Type |
| Proton Pass | 8/11 | メールエイリアス、Swiss 管轄、エコシステム |
| NordPass | 7/11 | XChaCha20、メールマスキング、オフライン |
| **passwd-sso** | **8/11** | E2E 暗号化、PQC 対応、セルフホスト、SAML SSO、Send |

**passwd-sso の差別化ポイント:**

- ML-KEM ハイブリッド PQC (緊急アクセス) — 競合で対応しているものは少ない
- 完全セルフホスト + SAML 2.0 SSO — Bitwarden 以外では稀
- 組織 Vault + 個人 E2E Vault の共存
- 監査ログの充実度 (36 アクション種別)
- Send (テキスト / ファイル一時共有) — Bitwarden と同等
- フォルダ階層 + エントリ変更履歴 + 重複検出 — Vault 管理の充実

**最大のギャップ:**

- モバイル / デスクトップアプリの不在
- メール通知基盤の欠如 (漏洩通知、緊急アクセス通知等)
- エンタープライズ機能 (SCIM, SIEM, ポリシー)
- ブラウザ拡張: 新規ログイン自動検出、カード / 住所の自動入力

**前回 (2026-02-17) からの改善:**

- ~~フォルダ / 階層整理の欠如~~ → フォルダ実装済み (個人 + 組織、最大 5 階層)
- ~~ブラウザ拡張の TOTP 自動入力~~ → 実装済み (SHA1/256/512)
- クリップボード自動クリア、マスターパスワード再確認、重複検出、有効期限、Send を追加
- Watchtower スコア計算に重複 + 期限切れを統合

---

## 6. 推奨次期バッチ (Batch D)

Phase 2 残 + P2 の早期着手可能な項目を組み合わせた次期実装候補:

### グループ A: ブラウザ拡張強化

| ID | 機能 | 難易度 | 備考 |
| --- | --- | --- | --- |
| X-5 | 新規ログイン自動検出・保存 | 中 | Phase 2 完了に必要。submit/fetch インターセプト |
| X-3 | コンテキストメニュー (右クリック) | 低 | Chrome `contextMenus` API |
| X-4 | 拡張キーボードショートカット | 低 | Chrome `commands` API |

### グループ B: セッション管理 + 通知基盤

| ID | 機能 | 難易度 | 備考 |
| --- | --- | --- | --- |
| S-5 | 並行セッション管理 (一覧/取消) | 中 | DB セッション既存。UI 追加が主 |
| N-1 | メール通知基盤 | 中 | Resend / SES。N-4, S-6 の前提 |
| N-4 | 緊急アクセス通知 (メール) | 低 | N-1 上に構築 |

### グループ C: エントリタイプ拡充

| ID | 機能 | 難易度 | 備考 |
| --- | --- | --- | --- |
| E-2 | 銀行口座 | 低 | enum 追加 + 暗号化ブロブ構造 + UI |
| E-3 | ソフトウェアライセンス | 低 | 同上 |
| E-4 | カスタムフィールド: BOOLEAN | 低 | enum 追加のみ |
| E-5 | カスタムフィールド: DATE, MONTH_YEAR | 低 | enum 追加のみ |

**推奨順序:** A → B → C (拡張機能の日常 UX 改善を優先)

---

*本レポートの競合情報は 2026 年 2 月時点のものです。各製品のプラン・提供形態により差異があります。*
